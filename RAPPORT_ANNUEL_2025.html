<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAPPORT ANNUEL 2025 - HACC</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #e74c3c;
            --accent-color: #3498db;
            --light-bg: #ecf0f1;
            --text-color: #333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #fff;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 210mm;
            /* A4 width */
            margin: 0 auto;
            padding: 20mm;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 20px;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.5em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        h2 {
            color: var(--accent-color);
            border-left: 5px solid var(--secondary-color);
            padding-left: 10px;
            margin-top: 30px;
        }

        h3 {
            color: var(--primary-color);
            margin-top: 20px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: var(--light-bg);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #bdc3c7;
        }

        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary-color);
        }

        .metric-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th,
        td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: var(--primary-color);
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .chart-container {
            margin: 30px 0;
            height: 300px;
        }

        .page-break {
            page-break-before: always;
        }

        .highlight-box {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        @media print {
            body {
                background: none;
            }

            .container {
                box-shadow: none;
                margin: 0;
                padding: 0;
            }

            .no-print {
                display: none;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>Rapport Annuel 2025</h1>
            <p>HACC - Analyse de Performance et Perspectives (Période Analysée: Février - Décembre 2025)</p>
        </header>

        <div class="highlight-box">
            <strong>Résumé Exécutif :</strong> Une année marquée par une croissance exceptionnelle au second semestre,
            atteignant un chiffre d'affaires cumulé de <strong>2,72 Milliards de FCFA</strong> sur la période
            Août-Décembre. Malgré des défis logistiques, la performance commerciale reste robuste.
        </div>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value">2,72 Milliards</div>
                <div class="metric-label">Chiffre d'Affaires Global (Août-Déc)</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">2,66 Milliards</div>
                <div class="metric-label">Résultat Net</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">55,5 Millions</div>
                <div class="metric-label">Dépenses Totales</div>
            </div>
        </div>

        <h2>1. Analyse Financière Mensuelle</h2>
        <p>Évolution du Chiffre d'Affaires et du Résultat Net sur le second semestre 2025.</p>

        <div class="chart-container">
            <canvas id="monthlyChart"></canvas>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Mois</th>
                    <th>Chiffre d'Affaires (FCFA)</th>
                    <th>Dépenses (FCFA)</th>
                    <th>Résultat Net (FCFA)</th>
                    <th>Croissance M/M</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Août</td>
                    <td>387 553 900</td>
                    <td>4 583 866</td>
                    <td>382 970 034</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>Septembre</td>
                    <td>379 219 900</td>
                    <td>1 973 485</td>
                    <td>377 246 415</td>
                    <td>-2.1%</td>
                </tr>
                <tr>
                    <td>Octobre</td>
                    <td>421 115 800</td>
                    <td>0</td>
                    <td>384 676 468</td>
                    <td>+11.0%</td>
                </tr>
                <tr>
                    <td>Novembre</td>
                    <td>721 639 000</td>
                    <td>0</td>
                    <td>716 138 725</td>
                    <td>+71.3%</td>
                </tr>
                <tr>
                    <td>Décembre</td>
                    <td>811 030 375</td>
                    <td>7 001 384</td>
                    <td>804 028 991</td>
                    <td>+12.4%</td>
                </tr>
            </tbody>
        </table>

        <div class="page-break"></div>

        <h2>2. Analyse Commerciale Détaillée</h2>

        <div style="display: flex; gap: 20px;">
            <div style="flex: 1;">
                <h3>Top 5 Clients (Contribution Revenu)</h3>
                <div class="chart-container">
                    <canvas id="clientsChart"></canvas>
                </div>
            </div>
            <div style="flex: 1;">
                <h3>Répartition par Produit (Volume Transactionnel)</h3>
                <div class="chart-container">
                    <canvas id="productsChart"></canvas>
                </div>
            </div>
        </div>

        <h3>Top 10 Clients Stratégiques</h3>
        <table>
            <thead>
                <tr>
                    <th>Rang</th>
                    <th>Client</th>
                    <th>Volume d'Achats (FCFA)</th>
                    <th>Part de Marché (Est.)</th>
                </tr>
            </thead>
            <tbody id="clientsTableBody">
                <!-- Data populated by script below -->
            </tbody>
        </table>

        <div class="page-break"></div>

        <h2>3. Analyse Opérationnelle et Qualitative</h2>

        <div class="metrics-grid" style="grid-template-columns: 1fr 1fr;">
            <div class="metric-card" style="text-align: left;">
                <h3 style="margin-top:0;">Défis Identifiés</h3>
                <ul style="padding-left: 20px;">
                    <li><strong>Logistique:</strong> Insuffisance de véhicules et problèmes de maintenance.</li>
                    <li><strong>Équipement:</strong> Manque d'EPI pour les manutentionnaires (tenues, chaussures).</li>
                    <li><strong>Stocks:</strong> Écarts d'inventaire récurrents signalés dans les rapports d'activité.
                    </li>
                </ul>
            </div>
            <div class="metric-card" style="text-align: left;">
                <h3 style="margin-top:0;">Recommandations 2026</h3>
                <ul style="padding-left: 20px;">
                    <li><strong>Investissements:</strong> Priorité à l'achat d'équipements de sécurité et de travail.
                    </li>
                    <li><strong>Processus:</strong> Digitalisation du suivi de stock pour réduire les écarts.</li>
                    <li><strong>RH:</strong> Renforcement des équipes commerciales pour soutenir la croissance de fin
                        d'année.</li>
                </ul>
            </div>
        </div>

        <h3>Détail des Produits (Top Performers)</h3>
        <table>
            <thead>
                <tr>
                    <th>Produit</th>
                    <th>Volume Vendu (FCFA)</th>
                    <th>Quantité</th>
                </tr>
            </thead>
            <tbody id="productsTableBody">
                <!-- Data populated by script below -->
            </tbody>
        </table>

    </div>

    <script>
        // Data injected from analysis
        const monthlyLabels = ['Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];
        const monthlySales = [387553900, 379219900, 421115800, 721639000, 811030375];
        const monthlyNet = [382970034, 377246415, 384676468, 716138725, 804028991];

        const topClients = [
            { name: "BONNE NOUVELLE", value: 395982500 },
            { name: "SIDDI", value: 379432500 },
            { name: "GALLUS", value: 322421500 },
            { name: "BOSTA", value: 319255000 },
            { name: "SANGHO", value: 247551000 },
            { name: "SAIDOU OBALA", value: 161047500 },
            { name: "MAMAN BOUTIQUE", value: 106954200 },
            { name: "MY AFRICA", value: 101783000 },
            { name: "CLT MERLINE", value: 68670400 },
            { name: "FOKA", value: 67375000 }
        ];

        const topProducts = [
            { name: "Bidon huile CEL'OR 20L conditionn├®e (01 bidon/1)", value: 2439771500, quantity: 97131 },
            { name: "Cartons huile CEL'OR 01L conditionn├®e (15  bouteilles/ct)", value: 92110200, quantity: 4578 },
            { name: "Cartons huile CEL'OR 05L conditionn├®e (03 bouteilles/ct)", value: 87834500, quantity: 4336 },
            { name: "Bidon huile CEL'OR 20L conditionn├®e (01 bidon/1)", value: 32549200, quantity: 1290 },
            { name: "Cartons savons CEL'OR 60*350g sc├®ll├®s (60 morceaux/ct)", value: 23678000, quantity: 1318 },
            { name: "Bidon d'huile 5 Litres (D├®tail)", value: 504000, quantity: 72 },
            { name: "Morceau de savon 60*350g Cel'Or (D├®tail)", value: 172200, quantity: 574 },
            { name: " Bouteille d'huile 1 litre (D├®tail)", value: 161850, quantity: 119 },
            { name: "Carton huile 5L", value: 0, quantity: 0 },
            { name: "Formats", value: 0, quantity: 0 }
        ];

        // clean product names
        const cleanProducts = topProducts.map(p => {
            return {
                name: p.name.replace(/conditionn├®e|sc├®ll├®s/g, '').replace(/\(.*\)/g, '').trim(),
                value: p.value,
                quantity: p.quantity
            };
        });

        // Populate Tables
        const clientsBody = document.getElementById('clientsTableBody');
        topClients.forEach((c, index) => {
            clientsBody.innerHTML += `<tr><td>${index + 1}</td><td>${c.name}</td><td>${c.value.toLocaleString()} FCFA</td><td>${((c.value / 2720558975) * 100).toFixed(1)}%</td></tr>`;
        });

        const productsBody = document.getElementById('productsTableBody');
        cleanProducts.forEach(p => {
            if (p.value > 0) {
                productsBody.innerHTML += `<tr><td>${p.name}</td><td>${p.value.toLocaleString()} FCFA</td><td>${p.quantity}</td></tr>`;
            }
        });

        // Monthly Chart
        new Chart(document.getElementById('monthlyChart'), {
            type: 'bar',
            data: {
                labels: monthlyLabels,
                datasets: [
                    {
                        label: 'Chiffre d\'Affaires',
                        data: monthlySales,
                        backgroundColor: '#3498db'
                    },
                    {
                        label: 'Résultat Net',
                        data: monthlyNet,
                        backgroundColor: '#2ecc71'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // Clients Chart (Pie)
        new Chart(document.getElementById('clientsChart'), {
            type: 'doughnut',
            data: {
                labels: topClients.slice(0, 5).map(c => c.name),
                datasets: [{
                    data: topClients.slice(0, 5).map(c => c.value),
                    backgroundColor: ['#2c3e50', '#e74c3c', '#ecf0f1', '#3498db', '#f1c40f']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Products Chart (Pie)
        new Chart(document.getElementById('productsChart'), {
            type: 'pie',
            data: {
                labels: cleanProducts.slice(0, 3).map(p => p.name),
                datasets: [{
                    data: cleanProducts.slice(0, 3).map(p => p.quantity),
                    backgroundColor: ['#e67e22', '#16a085', '#8e44ad']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

    </script>

</body>

</html>